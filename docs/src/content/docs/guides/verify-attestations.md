---
title: Verify Attestations
description: How to verify SBOM, CVE, and provenance attestations on Trusted Base Images using cosign.
---

Every Trusted Base Image has three attestations attached by the Build-Actor and verified by the Review-Actor before release:

1. **SBOM** (Software Bill of Materials) — SPDX format, generated by Syft
2. **CVE Report** — Vulnerability scan results, generated by Grype
3. **SLSA Provenance** — SLSA v1.0 build provenance

## Prerequisites

Install [cosign](https://docs.sigstore.dev/cosign/system_config/installation/) v2 or later:

```bash
# macOS
brew install cosign

# Linux (binary)
curl -sSfL https://github.com/sigstore/cosign/releases/latest/download/cosign-linux-amd64 -o /usr/local/bin/cosign
chmod +x /usr/local/bin/cosign
```

## Download Public Keys

The build attestations are signed with the Build-Actor's sovereign key. Download it from the repository:

```bash
curl -sSfL -o build.pub \
  https://raw.githubusercontent.com/infrashift/trusted-base-oci-images/main/.github/pdp/public-keys/build.pub
```

## Verify SBOM Attestation

```bash
cosign verify-attestation \
  --key build.pub \
  --type spdxjson \
  --insecure-ignore-tlog \
  --certificate-identity-regexp='.*' \
  --certificate-oidc-issuer-regexp='.*' \
  ghcr.io/infrashift/trusted-base-images/trusted/ubi9-standard:latest
```

## Verify CVE Report Attestation

```bash
cosign verify-attestation \
  --key build.pub \
  --type vuln \
  --insecure-ignore-tlog \
  --certificate-identity-regexp='.*' \
  --certificate-oidc-issuer-regexp='.*' \
  ghcr.io/infrashift/trusted-base-images/trusted/ubi9-standard:latest
```

## Verify SLSA Provenance Attestation

```bash
cosign verify-attestation \
  --key build.pub \
  --type slsaprovenance1 \
  --insecure-ignore-tlog \
  --certificate-identity-regexp='.*' \
  --certificate-oidc-issuer-regexp='.*' \
  ghcr.io/infrashift/trusted-base-images/trusted/ubi9-standard:latest
```

## Extract Attestation Payloads

To inspect the actual attestation content, pipe the output through `jq`:

```bash
# Extract SBOM
cosign verify-attestation \
  --key build.pub \
  --type spdxjson \
  --insecure-ignore-tlog \
  --certificate-identity-regexp='.*' \
  --certificate-oidc-issuer-regexp='.*' \
  ghcr.io/infrashift/trusted-base-images/trusted/ubi9-standard:latest \
  | jq -r '.payload' | base64 -d | jq '.predicate'
```

## Why `--insecure-ignore-tlog`?

Build and Review attestations use sovereign key signing with `--tlog-upload=false`. The transparency log is not used for these intermediate attestations — only the Release-Actor uploads to Rekor. This flag tells cosign to skip transparency log verification for these key-based signatures.

## Attestation Types

| Type | Predicate Type | Content |
|------|---------------|---------|
| `spdxjson` | SPDX SBOM | Package inventory generated by Syft |
| `vuln` | Grype scan | CVE matches with severity, package, and fix info |
| `slsaprovenance1` | SLSA v1.0 | Build source, parameters, resolved dependencies, builder info |
